<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3. Calculate the lowest elevation path and barrier height between stable states â€¢ simlandr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="3. Calculate the lowest elevation path and barrier height between stable states">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">simlandr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/barrier.html">3. Calculate the lowest elevation path and barrier height between stable states</a></li>
    <li><a class="dropdown-item" href="../articles/landscape.html">2. Construct the potential landscapes from simulation results</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">1. Dynamic models and simulations</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Sciurus365/simlandr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>3. Calculate the lowest elevation path and barrier height between stable states</h1>
                        <h4 data-toc-skip class="author">Jingmeng
Cui</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Sciurus365/simlandr/blob/master/vignettes/barrier.Rmd" class="external-link"><code>vignettes/barrier.Rmd</code></a></small>
      <div class="d-none name"><code>barrier.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sciurus365.github.io/simlandr/">simlandr</a></span><span class="op">)</span></span></code></pre></div>
<p>An important property of the states in a landscape is their (kinetic)
stability, characterized by the barrier height between these states and
other adjacent states. <code>simlandr</code> also provides tools to
calculate the barrier heights from landscapes.</p>
<p>You can use the general function <code><a href="../reference/calculate_barrier.html">calculate_barrier()</a></code> to
calculate the barrier for most landscapes. There are also specific
<code>calculate_barrier_*()</code> functions available. The output of
these functions is a `barrier object.</p>
<p>The <code>barrier</code> objects contain the potential function and
the position of both states and the saddle point. For 3D landscapes, the
minimum energy path (MEP) is also provided. <code>barrier</code>s can
also be calculated for landscapes from multiple simulations. In this
case, remember to set <code>individual_landscape = TRUE</code> in
landscape construction functions.</p>
<p>The local minimums are searched in a square space around a given
point. The point with the lowest potential value in the given region is
set as the position of the stable state. If all the potential values in
the region are equal to <code>Umax</code> (which represents
~<code>Inf</code>), the barrier calculation functions will expand the
searching area automatically. Use <code>expand = FALSE</code> to disable
this feature.</p>
<p>For landscapes from multiple simulations, the searching regions for
their starting and ending points can be different. <code>simlandr</code>
provides <code><a href="../reference/make_barrier_grid_2d.html">make_barrier_grid_2d()</a></code> and
<code><a href="../reference/make_barrier_grid_3d.html">make_barrier_grid_3d()</a></code> functions to help you put these
settings into a data frame with the correct format.</p>
<p>The <code>barrier</code> objects also provide a <code>ggplot</code>
geom object that can be added to the landscape plots to show the
starting (white), end (white), and saddle (red) points, as well as the
MEP (white line, only for 3d landscapes). Use <code>autolayer(b)</code>
to access those geoms.</p>
<p>Below are examples of different barrier calculations. See the help
documents of those functions for further details.</p>
<hr>
<p>Prepare data sets and landscapes (see
<code><a href="../articles/landscape.html">vignette("landscape")</a></code>)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">single_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_fun_test.html">sim_fun_test</a></span><span class="op">(</span></span>
<span>  arg1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ele1 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  arg2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ele2 <span class="op">=</span> <span class="fl">1</span>, ele3 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">l_single_2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_2d_static.html">make_2d_static</a></span><span class="op">(</span><span class="va">single_test</span>, x <span class="op">=</span> <span class="st">"out1"</span><span class="op">)</span></span>
<span><span class="va">l_single_3d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_3d_static.html">make_3d_static</a></span><span class="op">(</span><span class="va">single_test</span>, x <span class="op">=</span> <span class="st">"out1"</span>, y <span class="op">=</span> <span class="st">"out2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">batch_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arg_set-class.html">new_arg_set</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">batch_test</span> <span class="op">&lt;-</span> <span class="va">batch_test</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/arg_set-class.html">add_arg_ele</a></span><span class="op">(</span><span class="st">"arg2"</span>, <span class="st">"ele3"</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">batch_test_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arg_set-class.html">make_arg_grid</a></span><span class="op">(</span><span class="va">batch_test</span><span class="op">)</span></span>
<span><span class="va">batch_test_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/batch_simulation.html">batch_simulation</a></span><span class="op">(</span><span class="va">batch_test_grid</span>, <span class="va">sim_fun_test</span>,</span>
<span>  default_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    arg1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ele1 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    arg2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ele2 <span class="op">=</span> <span class="fl">0</span>, ele3 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  bigmemory <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">batch_test2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arg_set-class.html">new_arg_set</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">batch_test2</span> <span class="op">&lt;-</span> <span class="va">batch_test2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/arg_set-class.html">add_arg_ele</a></span><span class="op">(</span><span class="st">"arg1"</span>, <span class="st">"ele1"</span>, <span class="fl">0.2</span>, <span class="fl">0.6</span>, <span class="fl">0.2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/arg_set-class.html">add_arg_ele</a></span><span class="op">(</span><span class="st">"arg2"</span>, <span class="st">"ele2"</span>, <span class="fl">0.2</span>, <span class="fl">0.6</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">batch_test_grid2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arg_set-class.html">make_arg_grid</a></span><span class="op">(</span><span class="va">batch_test2</span><span class="op">)</span></span>
<span><span class="va">batch_test_result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/batch_simulation.html">batch_simulation</a></span><span class="op">(</span><span class="va">batch_test_grid2</span>, <span class="va">sim_fun_test</span>,</span>
<span>  default_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    arg1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ele1 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    arg2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ele2 <span class="op">=</span> <span class="fl">0</span>, ele3 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  bigmemory <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">l_batch_3d_m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_3d_matrix.html">make_3d_matrix</a></span><span class="op">(</span><span class="va">batch_test_result</span>, x <span class="op">=</span> <span class="st">"out1"</span>, y <span class="op">=</span> <span class="st">"out2"</span>, cols <span class="op">=</span> <span class="st">"ele3"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Wrangling the data...</span></span>
<span><span class="co">#&gt; Making the plots...</span></span>
<span><span class="va">l_batch_2d_m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_2d_matrix.html">make_2d_matrix</a></span><span class="op">(</span><span class="va">batch_test_result2</span>, x <span class="op">=</span> <span class="st">"out1"</span>, rows <span class="op">=</span> <span class="st">"ele1"</span>, cols <span class="op">=</span> <span class="st">"ele2"</span>, individual_landscape <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Wrangling the data...</span></span>
<span><span class="co">#&gt; Making the plots...</span></span>
<span><span class="va">l_batch_3d_m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_3d_matrix.html">make_3d_matrix</a></span><span class="op">(</span><span class="va">batch_test_result2</span>, x <span class="op">=</span> <span class="st">"out1"</span>, y <span class="op">=</span> <span class="st">"out2"</span>, rows <span class="op">=</span> <span class="st">"ele1"</span>, cols <span class="op">=</span> <span class="st">"ele2"</span>, Umax <span class="op">=</span> <span class="fl">10</span>, individual_landscape <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Wrangling the data...</span></span>
<span><span class="co">#&gt; Making the plots...</span></span></code></pre></div>
<hr>
<hr>
<p>Frequently used parameters for the family of barrier functions:</p>
<p><code>start_location_value</code>,<code>end_location_value</code>:
the initial position (in value) for searching the start/end point;
<code>start_r</code>,<code>end_r</code>: the searching (L1) radius for
searching the start/end point.</p>
<hr>
<div class="section level2">
<h2 id="barrier-calculation-for-2d-single-landscape">Barrier calculation for 2d single landscape<a class="anchor" aria-label="anchor" href="#barrier-calculation-for-2d-single-landscape"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_single_2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_barrier.html">calculate_barrier</a></span><span class="op">(</span><span class="va">l_single_2d</span>, start_location_value <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, end_location_value <span class="op">=</span> <span class="fl">2</span>, start_r <span class="op">=</span> <span class="fl">1</span>, end_r <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b_single_2d</span><span class="op">$</span><span class="va">local_min_start</span></span>
<span><span class="co">#&gt; $U</span></span>
<span><span class="co">#&gt; [1] 1.200247</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $location</span></span>
<span><span class="co">#&gt;   x_index   x_value </span></span>
<span><span class="co">#&gt; 22.000000 -2.677756</span></span>
<span><span class="va">b_single_2d</span><span class="op">$</span><span class="va">local_min_end</span></span>
<span><span class="co">#&gt; $U</span></span>
<span><span class="co">#&gt; [1] 1.196954</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $location</span></span>
<span><span class="co">#&gt;    x_index    x_value </span></span>
<span><span class="co">#&gt; 179.000000   2.677764</span></span>
<span><span class="va">b_single_2d</span><span class="op">$</span><span class="va">saddle_point</span></span>
<span><span class="co">#&gt; $U</span></span>
<span><span class="co">#&gt; [1] 2.186844</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $location</span></span>
<span><span class="co">#&gt;      x_index      x_value </span></span>
<span><span class="co">#&gt; 103.00000000   0.08528284</span></span>
<span></span>
<span><span class="fu"><a href="../reference/get_barrier_height.html">get_barrier_height</a></span><span class="op">(</span><span class="va">b_single_2d</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `summary()` was deprecated in simlandr 0.3.0.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; delta_U_start   delta_U_end </span></span>
<span><span class="co">#&gt;     0.9865968     0.9898904</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">l_single_2d</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/autolayer.html">autolayer</a></span><span class="op">(</span><span class="va">b_single_2d</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in ggplot2::geom_point(mapping = ggplot2::aes(x = d$x[s_location_x_index], : All aesthetics have length 1, but the data has 200 rows.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Please consider using `annotate()` or provide this layer with data containing</span></span>
<span><span class="co">#&gt;   a single row.</span></span>
<span><span class="co">#&gt; Warning in ggplot2::geom_point(mapping = ggplot2::aes(x = local_min_start$location["x_value"], : All aesthetics have length 1, but the data has 200 rows.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Please consider using `annotate()` or provide this layer with data containing</span></span>
<span><span class="co">#&gt;   a single row.</span></span>
<span><span class="co">#&gt; Warning in ggplot2::geom_point(mapping = ggplot2::aes(x = local_min_end$location["x_value"], : All aesthetics have length 1, but the data has 200 rows.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Please consider using `annotate()` or provide this layer with data containing</span></span>
<span><span class="co">#&gt;   a single row.</span></span></code></pre></div>
<p><img src="barrier_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="barrier-calculation-for-3d-single-landscape">Barrier calculation for 3d single landscape<a class="anchor" aria-label="anchor" href="#barrier-calculation-for-3d-single-landscape"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_single_3d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_barrier.html">calculate_barrier</a></span><span class="op">(</span><span class="va">l_single_3d</span>, start_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, end_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">0</span><span class="op">)</span>, start_r <span class="op">=</span> <span class="fl">0.3</span>, end_r <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">l_single_3d</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/autolayer.html">autolayer</a></span><span class="op">(</span><span class="va">b_single_3d</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in ggplot2::geom_point(ggplot2::aes(x = local_min_start$location["x_value"], : All aesthetics have length 1, but the data has 40000 rows.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Please consider using `annotate()` or provide this layer with data containing</span></span>
<span><span class="co">#&gt;   a single row.</span></span>
<span><span class="co">#&gt; Warning in ggplot2::geom_point(ggplot2::aes(x = local_min_end$location["x_value"], : All aesthetics have length 1, but the data has 40000 rows.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Please consider using `annotate()` or provide this layer with data containing</span></span>
<span><span class="co">#&gt;   a single row.</span></span>
<span><span class="co">#&gt; Warning in ggplot2::geom_point(ggplot2::aes(x = saddle_point$location["x_value"], : All aesthetics have length 1, but the data has 40000 rows.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Please consider using `annotate()` or provide this layer with data containing</span></span>
<span><span class="co">#&gt;   a single row.</span></span></code></pre></div>
<p><img src="barrier_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="barrier-calculation-for-2d-batch-landscape">Barrier calculation for 2d batch landscape<a class="anchor" aria-label="anchor" href="#barrier-calculation-for-2d-batch-landscape"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_batch_2d_m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_barrier.html">calculate_barrier</a></span><span class="op">(</span><span class="va">l_batch_2d_m2</span>, start_location_value <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, end_location_value <span class="op">=</span> <span class="fl">1</span>, start_r <span class="op">=</span> <span class="fl">0.99</span>, end_r <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">l_batch_2d_m2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/autolayer.html">autolayer</a></span><span class="op">(</span><span class="va">b_batch_2d_m2</span><span class="op">)</span></span></code></pre></div>
<p><img src="barrier_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="barrier-calculation-for-3d-batch-landscape">Barrier calculation for 3d batch landscape<a class="anchor" aria-label="anchor" href="#barrier-calculation-for-3d-batch-landscape"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_batch_3d_m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_barrier.html">calculate_barrier</a></span><span class="op">(</span><span class="va">l_batch_3d_m2</span>, start_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, end_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, start_r <span class="op">=</span> <span class="fl">0.9</span>, end_r <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">l_batch_3d_m2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/autolayer.html">autolayer</a></span><span class="op">(</span><span class="va">b_batch_3d_m2</span><span class="op">)</span></span></code></pre></div>
<p><img src="barrier_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="set-the-starting-and-end-values-for-each-landscape">Set the starting and end values for each landscape<a class="anchor" aria-label="anchor" href="#set-the-starting-and-end-values-for-each-landscape"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_batch_3d_m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_barrier.html">calculate_barrier</a></span><span class="op">(</span><span class="va">l_batch_3d_m1</span>, start_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, end_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, start_r <span class="op">=</span> <span class="fl">0.3</span>, end_r <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="co">#&gt; The U in this range is too high. Searching range expanded...</span></span>
<span><span class="co">#&gt; r = c(0.832073521958355,0.764100483821545)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">l_batch_3d_m1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/autolayer.html">autolayer</a></span><span class="op">(</span><span class="va">b_batch_3d_m1</span><span class="op">)</span></span></code></pre></div>
<p><img src="barrier_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## This barrier calculation doesn't find proper local minimums for several landscapes. Specify the searching parameters per landscape manually.</span></span>
<span><span class="co">## First, print a template of the data format.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/make_barrier_grid_3d.html">make_barrier_grid_3d</a></span><span class="op">(</span><span class="va">batch_test_grid</span>, start_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, end_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, start_r <span class="op">=</span> <span class="fl">0.3</span>, end_r <span class="op">=</span> <span class="fl">0.6</span>, print_template <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; structure(list(start_location_value = list(c(0, 0), c(0, 0), </span></span>
<span><span class="co">#&gt;     c(0, 0), c(0, 0)), start_r = list(c(0.3, 0.3), c(0.3, 0.3</span></span>
<span><span class="co">#&gt; ), c(0.3, 0.3), c(0.3, 0.3)), end_location_value = list(c(2, </span></span>
<span><span class="co">#&gt; 1), c(2, 1), c(2, 1), c(2, 1)), end_r = list(c(0.6, 0.6), c(0.6, </span></span>
<span><span class="co">#&gt; 0.6), c(0.6, 0.6), c(0.6, 0.6))), row.names = c(NA, -4L), class = c("arg_grid", </span></span>
<span><span class="co">#&gt; "data.frame"))</span></span>
<span><span class="co">#&gt;   ele_list ele3 start_location_value  start_r end_location_value    end_r</span></span>
<span><span class="co">#&gt; 1      0.2  0.2                 0, 0 0.3, 0.3               2, 1 0.6, 0.6</span></span>
<span><span class="co">#&gt; 2      0.3  0.3                 0, 0 0.3, 0.3               2, 1 0.6, 0.6</span></span>
<span><span class="co">#&gt; 3      0.4  0.4                 0, 0 0.3, 0.3               2, 1 0.6, 0.6</span></span>
<span><span class="co">#&gt; 4      0.5  0.5                 0, 0 0.3, 0.3               2, 1 0.6, 0.6</span></span>
<span></span>
<span><span class="co">## Then, modify the parameters as you want, and send this `barrier_grid` to the barrier calculation function.</span></span>
<span><span class="va">b_batch_3d_m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_barrier.html">calculate_barrier</a></span><span class="op">(</span></span>
<span>  <span class="va">l_batch_3d_m1</span>,</span>
<span>  <span class="fu"><a href="../reference/make_barrier_grid_3d.html">make_barrier_grid_3d</a></span><span class="op">(</span><span class="va">batch_test_grid</span>,</span>
<span>    df <span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>start_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="op">)</span>, start_r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>, end_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.8</span>, <span class="fl">0.8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, end_r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span></span>
<span>      <span class="op">)</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="op">-</span><span class="fl">4L</span><span class="op">)</span>, class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"arg_grid"</span>,</span>
<span>        <span class="st">"data.frame"</span></span>
<span>      <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">l_batch_3d_m1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/autolayer.html">autolayer</a></span><span class="op">(</span><span class="va">b_batch_3d_m1</span><span class="op">)</span></span></code></pre></div>
<p><img src="barrier_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Now it works well.</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jingmeng Cui.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
