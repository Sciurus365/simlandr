<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3. Calculate the lowest elevation path and barrier height between stable states â€¢ simlandr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="3. Calculate the lowest elevation path and barrier height between stable states">
<meta property="og:description" content="simlandr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simlandr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simulation.html">1. Dynamic models and simulations</a>
    </li>
    <li>
      <a href="../articles/landscape.html">2. Construct the potential landscapes from simulation results</a>
    </li>
    <li>
      <a href="../articles/barrier.html">3. Calculate the lowest elevation path and barrier height between stable states</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Sciurus365/simlandr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="barrier_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>3. Calculate the lowest elevation path and barrier height between stable states</h1>
                        <h4 class="author">Jingmeng Cui</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Sciurus365/simlandr/blob/master/vignettes/barrier.Rmd"><code>vignettes/barrier.Rmd</code></a></small>
      <div class="hidden name"><code>barrier.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sciurus365.github.io/simlandr/">simlandr</a></span><span class="op">)</span></code></pre></div>
<p>An important property of the states in a landscape is their stability, characterized by the barrier height between these states and other adjacent states. <code>simlandr</code> also provides tools to calculate the barrier heights from landscapes.</p>
<p>You can use the general function <code><a href="../reference/calculate_barrier.html">calculate_barrier()</a></code> to calculate the barrier for most landscapes. There are also specific <code>calculate_barrier_*()</code> functions available. The output of these functions is a `barrier object.</p>
<p>The <code>barrier</code> objects contain the potential function and the position of both states and the saddle point. For 3D landscapes, the lowest elevation path (LEP) is also provided. <code>barrier</code>s can also be calculated for landscapes from multiple simulations. In this case, remember to set <code>individual_landscape = TRUE</code> in landscape construction functions.</p>
<p>The local minimums are searched in a square space around a given point. The point with the lowest potential value in the given region is set as the position of the stable state. If all the potential values in the region are equal to <code>Umax</code> (which represents ~<code>Inf</code>), the barrier calculation functions will expand the searching area automatically. Use <code>expand = FALSE</code> to disable this feature.</p>
<p>For landscapes from multiple simulations, the searching regions for their starting and ending points can be different. <code>simlandr</code> provides <code><a href="../reference/make_barrier_grid_2d.html">make_barrier_grid_2d()</a></code> and <code><a href="../reference/make_barrier_grid_3d.html">make_barrier_grid_3d()</a></code> functions to help you put these settings into a data frame with the correct format.</p>
<p>The <code>barrier</code> objects also provide a <code>ggplot</code> geom object that can be added to the landscape plots to show the starting (white), end (white), and saddle (red) points, as well as the LEP (white line, only for 3d landscapes). Use <code><a href="../reference/get_geom.html">get_geom(b)</a></code> to access those geoms.</p>
<p>Below are examples of different barrier calculations. See the help documents of those functions for further details.</p>
<hr>
<p>Prepare data sets and landscapes (see <code><a href="../articles/landscape.html">vignette("landscape")</a></code>)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">single_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_fun_test.html">sim_fun_test</a></span><span class="op">(</span>
  par1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>var1 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
  par2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>var2 <span class="op">=</span> <span class="fl">1</span>, var3 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">l_single_2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_2d_density.html">make_2d_density</a></span><span class="op">(</span><span class="va">single_test</span>, x <span class="op">=</span> <span class="st">"out1"</span>, from <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">2</span>, adjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">l_single_3d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_3d_static.html">make_3d_static</a></span><span class="op">(</span><span class="va">single_test</span>, x <span class="op">=</span> <span class="st">"out1"</span>, y <span class="op">=</span> <span class="st">"out2"</span>, lims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, h <span class="op">=</span> <span class="fl">0.01</span>, kde_fun <span class="op">=</span> <span class="st">"ks"</span><span class="op">)</span>
<span class="co">#&gt; Calculating the smooth distribution...</span>
<span class="co">#&gt; Done!</span>
<span class="co">#&gt; Making the plot...</span>
<span class="co">#&gt; Done!</span>
<span class="co">#&gt; Making the 2d plot...</span>
<span class="co">#&gt; Done!</span>

<span class="va">batch_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_var_set.html">new_var_set</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">batch_test</span> <span class="op">&lt;-</span> <span class="va">batch_test</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/new_var_set.html">add_var</a></span><span class="op">(</span><span class="st">"par2"</span>, <span class="st">"var3"</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span>
<span class="va">batch_test_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_var_grid.html">make_var_grid</a></span><span class="op">(</span><span class="va">batch_test</span><span class="op">)</span>
<span class="va">batch_test_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modified_simulation.html">batch_simulation</a></span><span class="op">(</span><span class="va">batch_test_grid</span>, <span class="va">sim_fun_test</span>,
  default_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    par1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>var1 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
    par2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>var2 <span class="op">=</span> <span class="fl">0</span>, var3 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span>,
  bigmemory <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="va">batch_test2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_var_set.html">new_var_set</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">batch_test2</span> <span class="op">&lt;-</span> <span class="va">batch_test2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/new_var_set.html">add_var</a></span><span class="op">(</span><span class="st">"par1"</span>, <span class="st">"var1"</span>, <span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/new_var_set.html">add_var</a></span><span class="op">(</span><span class="st">"par2"</span>, <span class="st">"var2"</span>, <span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span>
<span class="va">batch_test_grid2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_var_grid.html">make_var_grid</a></span><span class="op">(</span><span class="va">batch_test2</span><span class="op">)</span>
<span class="va">batch_test_result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modified_simulation.html">batch_simulation</a></span><span class="op">(</span><span class="va">batch_test_grid2</span>, <span class="va">sim_fun_test</span>,
  default_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    par1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>var1 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
    par2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>var2 <span class="op">=</span> <span class="fl">0</span>, var3 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span>,
  bigmemory <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="va">l_batch_2d_m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_2d_matrix.html">make_2d_matrix</a></span><span class="op">(</span><span class="va">batch_test_result2</span>, x <span class="op">=</span> <span class="st">"out1"</span>, rows <span class="op">=</span> <span class="st">"var1"</span>, cols <span class="op">=</span> <span class="st">"var2"</span>, from <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, to <span class="op">=</span> <span class="fl">1</span>, adjust <span class="op">=</span> <span class="fl">0.1</span>, individual_landscape <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Making the plot...</span>
<span class="co">#&gt; Done!</span>
<span class="va">l_batch_3d_m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_3d_matrix.html">make_3d_matrix</a></span><span class="op">(</span><span class="va">batch_test_result2</span>, x <span class="op">=</span> <span class="st">"out1"</span>, y <span class="op">=</span> <span class="st">"out2"</span>, rows <span class="op">=</span> <span class="st">"var1"</span>, cols <span class="op">=</span> <span class="st">"var2"</span>, lims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, h <span class="op">=</span> <span class="fl">0.001</span>, kde_fun <span class="op">=</span> <span class="st">"ks"</span>, Umax <span class="op">=</span> <span class="fl">10</span>, individual_landscape <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Making the 2d plot...</span>
<span class="co">#&gt; Done!</span>
<span class="va">l_batch_3d_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_3d_animation.html">make_3d_animation</a></span><span class="op">(</span><span class="va">batch_test_result</span>, x <span class="op">=</span> <span class="st">"out1"</span>, y <span class="op">=</span> <span class="st">"out2"</span>, fr <span class="op">=</span> <span class="st">"var3"</span>, Umax <span class="op">=</span> <span class="fl">20</span>, lims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, h <span class="op">=</span> <span class="fl">0.002</span>, individual_landscape <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Wrangling data...</span>
<span class="co">#&gt; Done!</span>
<span class="co">#&gt; Making the plot...</span>
<span class="co">#&gt; Done!</span>
<span class="co">#&gt; Making the 2d plot...</span>
<span class="co">#&gt; Done!</span>
<span class="co">#&gt; Making the 3d matrix...</span>
<span class="co">#&gt; Making the 2d plot...</span>
<span class="co">#&gt; Done!</span>
<span class="co">#&gt; Done!</span></code></pre></div>
<hr>
<hr>
<p>Frequently used parameters for the family of barrier functions:</p>
<p><code>start_location_value</code>,<code>end_location_value</code>: the initial position (in value) for searching the start/end point; <code>start_r</code>,<code>end_r</code>: the searching (L1) radius for searching the start/end point.</p>
<hr>
<div id="barrier-calculation-for-2d-single-landscape" class="section level1">
<h1 class="hasAnchor">
<a href="#barrier-calculation-for-2d-single-landscape" class="anchor"></a>Barrier calculation for 2d single landscape</h1>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b_single_2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_barrier_2d.html">calculate_barrier_2d</a></span><span class="op">(</span><span class="va">l_single_2d</span>, start_location_value <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, end_location_value <span class="op">=</span> <span class="fl">2</span>, start_r <span class="op">=</span> <span class="fl">0.3</span>, end_r <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>

<span class="va">b_single_2d</span><span class="op">$</span><span class="va">local_min_start</span>
<span class="co">#&gt; $U</span>
<span class="co">#&gt; [1] 1.722065</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $location</span>
<span class="co">#&gt; x_index x_value </span>
<span class="co">#&gt;       1      -2</span>
<span class="va">b_single_2d</span><span class="op">$</span><span class="va">local_min_end</span>
<span class="co">#&gt; $U</span>
<span class="co">#&gt; [1] 1.723732</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $location</span>
<span class="co">#&gt; x_index x_value </span>
<span class="co">#&gt;     512       2</span>
<span class="va">b_single_2d</span><span class="op">$</span><span class="va">saddle_point</span>
<span class="co">#&gt; $U</span>
<span class="co">#&gt; [1] 2.167971</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $location</span>
<span class="co">#&gt;      x_index      x_value </span>
<span class="co">#&gt; 267.00000000   0.08219178</span>

<span class="fu"><a href="../reference/get_barrier_height.html">get_barrier_height</a></span><span class="op">(</span><span class="va">b_single_2d</span><span class="op">)</span>
<span class="co">#&gt; delta_U_start   delta_U_end </span>
<span class="co">#&gt;     0.4459061     0.4442392</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">l_single_2d</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/get_geom.html">get_geom</a></span><span class="op">(</span><span class="va">b_single_2d</span><span class="op">)</span></code></pre></div>
<p><img src="barrier_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="barrier-calculation-for-3d-single-landscape" class="section level1">
<h1 class="hasAnchor">
<a href="#barrier-calculation-for-3d-single-landscape" class="anchor"></a>Barrier calculation for 3d single landscape</h1>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b_single_3d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_barrier_3d.html">calculate_barrier_3d</a></span><span class="op">(</span><span class="va">l_single_3d</span>, start_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, end_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">0</span><span class="op">)</span>, start_r <span class="op">=</span> <span class="fl">0.3</span>, end_r <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">l_single_3d</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/get_geom.html">get_geom</a></span><span class="op">(</span><span class="va">b_single_3d</span><span class="op">)</span></code></pre></div>
<p><img src="barrier_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="barrier-calculation-for-2d-batch-landscape" class="section level1">
<h1 class="hasAnchor">
<a href="#barrier-calculation-for-2d-batch-landscape" class="anchor"></a>Barrier calculation for 2d batch landscape</h1>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b_batch_2d_m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_barrier_2d_batch.html">calculate_barrier_2d_batch</a></span><span class="op">(</span><span class="va">l_batch_2d_m2</span>, start_location_value <span class="op">=</span> <span class="op">-</span><span class="fl">0.35</span>, end_location_value <span class="op">=</span> <span class="fl">0.35</span>, start_r <span class="op">=</span> <span class="fl">0.34</span>, end_r <span class="op">=</span> <span class="fl">0.34</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">l_batch_2d_m2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/get_geom.html">get_geom</a></span><span class="op">(</span><span class="va">b_batch_2d_m2</span><span class="op">)</span></code></pre></div>
<p><img src="barrier_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div id="barrier-calculation-for-3d-batch-landscape" class="section level1">
<h1 class="hasAnchor">
<a href="#barrier-calculation-for-3d-batch-landscape" class="anchor"></a>Barrier calculation for 3d batch landscape</h1>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b_batch_3d_m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_barrier_3d_batch.html">calculate_barrier_3d_batch</a></span><span class="op">(</span><span class="va">l_batch_3d_m2</span>, start_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, end_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, start_r <span class="op">=</span> <span class="fl">0.3</span>, end_r <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.691959798994974,0.691959798994974)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.752261306532662,0.752261306532662)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.691959798994974,0.691959798994974)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.691959798994974,0.691959798994974)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.601507537688441,0.601507537688441)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.571356783919597,0.571356783919597)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.752261306532662,0.752261306532662)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.752261306532662,0.752261306532662)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.903015075376882,0.903015075376882)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.903015075376882,0.903015075376882)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.752261306532662,0.752261306532662)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.752261306532662,0.752261306532662)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.691959798994974,0.691959798994974)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.631658291457285,0.631658291457285)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.691959798994974,0.691959798994974)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.691959798994974,0.691959798994974)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.631658291457285,0.631658291457285)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(0.691959798994974,0.691959798994974)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">l_batch_3d_m2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/get_geom.html">get_geom</a></span><span class="op">(</span><span class="va">b_batch_3d_m2</span><span class="op">)</span></code></pre></div>
<p><img src="barrier_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="set-the-starting-and-end-values-for-each-landscape" class="section level1">
<h1 class="hasAnchor">
<a href="#set-the-starting-and-end-values-for-each-landscape" class="anchor"></a>Set the starting and end values for each landscape</h1>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b_batch_3d_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_barrier.html">calculate_barrier</a></span><span class="op">(</span><span class="va">l_batch_3d_a</span>, start_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, end_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, start_r <span class="op">=</span> <span class="fl">0.3</span>, end_r <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(1.83618090452261,1.83618090452261)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(1.41407035175879,1.41407035175879)</span>
<span class="co">#&gt; The U in this range is too high. Searching range expanded...</span>
<span class="co">#&gt; r = c(1.02211055276382,1.02211055276382)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">l_batch_3d_a</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/get_geom.html">get_geom</a></span><span class="op">(</span><span class="va">b_batch_3d_a</span><span class="op">)</span></code></pre></div>
<p><img src="barrier_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">## This barrier calculation doesn't find proper local minimums for several landscapes. Specify the searching parameters per landscape manually.</span>
<span class="co">## First, print a template of the data format.</span>

<span class="fu"><a href="../reference/make_barrier_grid_3d.html">make_barrier_grid_3d</a></span><span class="op">(</span><span class="va">batch_test_grid</span>, start_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, end_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, start_r <span class="op">=</span> <span class="fl">0.3</span>, end_r <span class="op">=</span> <span class="fl">0.6</span>, print_template <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; structure(list(start_location_value = list(c(0, 0), c(0, 0), </span>
<span class="co">#&gt;     c(0, 0), c(0, 0), c(0, 0), c(0, 0)), start_r = list(c(0.3, </span>
<span class="co">#&gt; 0.3), c(0.3, 0.3), c(0.3, 0.3), c(0.3, 0.3), c(0.3, 0.3), c(0.3, </span>
<span class="co">#&gt; 0.3)), end_location_value = list(c(2, 1), c(2, 1), c(2, 1), c(2, </span>
<span class="co">#&gt; 1), c(2, 1), c(2, 1)), end_r = list(c(0.6, 0.6), c(0.6, 0.6), </span>
<span class="co">#&gt;     c(0.6, 0.6), c(0.6, 0.6), c(0.6, 0.6), c(0.6, 0.6))), row.names = c(NA, </span>
<span class="co">#&gt; -6L), class = c("var_grid", "data.frame"))</span>
<span class="co">#&gt;   var_list var3 start_location_value  start_r end_location_value    end_r</span>
<span class="co">#&gt; 1        0  0.0                 0, 0 0.3, 0.3               2, 1 0.6, 0.6</span>
<span class="co">#&gt; 2      0.1  0.1                 0, 0 0.3, 0.3               2, 1 0.6, 0.6</span>
<span class="co">#&gt; 3      0.2  0.2                 0, 0 0.3, 0.3               2, 1 0.6, 0.6</span>
<span class="co">#&gt; 4      0.3  0.3                 0, 0 0.3, 0.3               2, 1 0.6, 0.6</span>
<span class="co">#&gt; 5      0.4  0.4                 0, 0 0.3, 0.3               2, 1 0.6, 0.6</span>
<span class="co">#&gt; 6      0.5  0.5                 0, 0 0.3, 0.3               2, 1 0.6, 0.6</span>

<span class="co">## Then, modify the parameters as you want, and send this `barrier_grid` to the barrier calculation function.</span>
<span class="va">b_batch_3d_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_barrier_3d_batch.html">calculate_barrier_3d_batch</a></span><span class="op">(</span>
  <span class="va">l_batch_3d_a</span>,
  <span class="fu"><a href="../reference/make_barrier_grid_3d.html">make_barrier_grid_3d</a></span><span class="op">(</span><span class="va">batch_test_grid</span>,
    df <span class="op">=</span>
      <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>start_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
      <span class="op">)</span>, start_r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="fl">0.1</span>,
        <span class="fl">0.1</span>
      <span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="fl">0.3</span>,
        <span class="fl">0.3</span>
      <span class="op">)</span><span class="op">)</span>, end_location_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="fl">1</span>,
        <span class="fl">0.5</span>
      <span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.8</span>, <span class="fl">0.8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, end_r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="fl">0.6</span>, <span class="fl">0.6</span>,
        <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>
      <span class="op">)</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="op">-</span><span class="fl">6L</span><span class="op">)</span>, class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="st">"var_grid"</span>,
        <span class="st">"data.frame"</span>
      <span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">l_batch_3d_a</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/get_geom.html">get_geom</a></span><span class="op">(</span><span class="va">b_batch_3d_a</span><span class="op">)</span>
<span class="co">#&gt; geom_path: Each group consists of only one observation. Do you need to adjust</span>
<span class="co">#&gt; the group aesthetic?</span></code></pre></div>
<p><img src="barrier_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">## Now it works well.</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jingmeng Cui.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
